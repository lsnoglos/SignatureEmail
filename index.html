<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firma de Correo Personalizado</title>
    <meta name="description" content="Crea tu firma de correo profesional fácilmente. Personaliza tus datos, elige plantillas, sube imágenes y obtén tu firma profesional fácilmente.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=PT+Sans:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --background: hsl(0 0% 96%);
            --foreground: hsl(145 30% 20%);
            --card: hsl(0 0% 100%);
            --card-foreground: hsl(145 30% 20%);
            --primary: hsl(145 60% 35%);
            --primary-foreground: hsl(0 0% 100%);
            --muted: hsl(0 0% 92%);
            --muted-foreground: hsl(145 20% 45%);
            --accent: hsl(0 70% 50%);
            --accent-foreground: hsl(0 0% 100%);
            --destructive: hsl(0 84.2% 60.2%);
            --destructive-foreground: hsl(0 0% 98%);
            --border: hsl(145 40% 75%);
            --input: hsl(145 40% 85%);
            --ring: hsl(145 60% 45%);
            --radius: 0.5rem;
        }
        *, *::before, *::after { box-sizing: border-box; border-color: var(--border); margin: 0; padding: 0; }
        body { font-family: 'PT Sans', sans-serif; background-color: var(--background); color: var(--foreground); -webkit-font-smoothing: antialiased; line-height: 1.5; }
        .font-headline { font-family: 'Poppins', sans-serif; }
        .container { width: 100%; margin-left: auto; margin-right: auto; padding-left: 1rem; padding-right: 1rem; }
        @media (min-width: 1280px) { .container { max-width: 1280px; } }
        .min-h-screen { min-height: 100vh; }
        .p-4 { padding: 1rem; } .p-6 { padding: 1.5rem; } .p-8 { padding: 2rem; }
        .mb-1 { margin-bottom: 0.25rem; } .mb-2 { margin-bottom: 0.5rem; } .mb-8 { margin-bottom: 2rem; }
        .mt-1 { margin-top: 0.25rem; } .mt-2 { margin-top: 0.5rem; } .mt-4 { margin-top: 1rem; } .mt-12 { margin-top: 3rem; }
        .pt-3 { padding-top: 0.75rem; } .pt-8 { padding-top: 2rem; }
        .space-y-2 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.5rem; } .space-y-3 > :not([hidden]) ~ :not([hidden]) { margin-top: 0.75rem; } .space-y-4 > :not([hidden]) ~ :not([hidden]) { margin-top: 1rem; } .space-y-6 > :not([hidden]) ~ :not([hidden]) { margin-top: 1.5rem; }
        .space-x-2 > :not([hidden]) ~ :not([hidden]) { margin-left: 0.5rem; }
        .gap-2 { gap: 0.5rem; } .gap-3 { gap: 0.75rem; } .gap-4 { gap: 1rem; } .gap-8 { gap: 2rem; }
        .text-center { text-align: center; } .text-xs { font-size: 0.75rem; } .text-sm { font-size: 0.875rem; } .text-lg { font-size: 1.125rem; } .text-xl { font-size: 1.25rem; } .text-4xl { font-size: 2.25rem; }
        .font-bold { font-weight: 700; } .font-semibold { font-weight: 600; } .font-medium { font-weight: 500; }
        .text-primary { color: var(--primary); } .text-muted-foreground { color: var(--muted-foreground); }
        .bg-muted\/30 { background-color: rgba(234, 234, 234, 0.3); } .bg-white { background-color: #fff; }
        .max-w-xl { max-width: 36rem; } .mx-auto { margin-left: auto; margin-right: auto; }
        .inline-flex { display: inline-flex; } .flex { display: flex; } .grid { display: grid; }
        .items-center { align-items: center; } .items-end { align-items: flex-end; }
        .justify-between { justify-content: space-between; } .flex-col { flex-direction: column; }
        .flex-grow { flex-grow: 1; }
        .grid-cols-1 { grid-template-columns: 1fr; } .grid-cols-2 { grid-template-columns: repeat(2, 1fr); } .grid-cols-4 { grid-template-columns: repeat(4, 1fr); }
        .w-full { width: 100%; } .h-full { height: 100%; }

        .card { background-color: var(--card); color: var(--card-foreground); border-radius: var(--radius); border: 1px solid var(--border); box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); }
        .card-header { padding: 1.5rem; } .card-content { padding: 1.5rem; }
        .card-title { font-size: 1.25rem; font-weight: 600; }
        .btn { display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; white-space: nowrap; border-radius: 0.375rem; font-size: 0.875rem; font-weight: 500; transition: all 0.15s ease-in-out; cursor: pointer; padding: 0.5rem 1rem; border: 1px solid transparent; }
        .btn-accent { background-color: var(--accent); color: var(--accent-foreground); } .btn-accent:hover { opacity: 0.9; }
        .input, .select, .textarea { display: flex; height: 2.5rem; width: 100%; border-radius: 0.375rem; border: 1px solid var(--input); background-color: var(--background); padding: 0.5rem 0.75rem; font-size: 0.875rem; }
        .textarea { min-height: 80px; resize: vertical; }
        .label { font-size: 0.875rem; font-weight: 500; display: flex; align-items: center; gap: 0.5rem; }
        .switch { position: relative; display: inline-block; width: 40px; height: 24px; } .switch input { opacity: 0; width: 0; height: 0; } .switch-slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px; } .switch-slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; } .switch input:checked + .switch-slider { background-color: var(--primary); } .switch input:checked + .switch-slider:before { transform: translateX(16px); }
        .separator { height: 1px; width: 100%; background-color: var(--border); margin: 1.5rem 0; }
        .icon { width: 1rem; height: 1rem; stroke-width: 2; vertical-align: middle; } .icon-xl { width: 2.5rem; height: 2.5rem; stroke: var(--primary); }
        .hidden { display: none !important; }
        #toaster-container { position: fixed; bottom: 1.5rem; right: 1.5rem; z-index: 9999; }
        .toast { padding: 1rem; background-color: var(--foreground); color: var(--background); border-radius: var(--radius); box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1); opacity: 0; transform: translateY(20px); animation: toast-in 0.5s forwards; } .toast.destructive { background-color: var(--destructive); color: var(--destructive-foreground); } .toast-title { font-weight: 600; }
        @keyframes toast-in { to { opacity: 1; transform: translateY(0); } }
        .image-preview { position: relative; width: 8rem; height: 8rem; border: 1px solid var(--border); border-radius: 0.375rem; overflow: hidden; box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1); } .image-preview img { width: 100%; height: 100%; object-fit: cover; } .image-preview .remove-btn { position: absolute; top: 0.25rem; right: 0.25rem; background-color: rgba(255, 255, 255, 0.7); border-radius: 9999px; width: 1.5rem; height: 1.5rem; padding: 0; } .image-preview .remove-btn:hover { background-color: var(--destructive); color: var(--destructive-foreground); }
        footer { margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border); text-align: center; font-size: 0.875rem; color: var(--muted-foreground); }

        .main-layout-container {
            display: flex;
            flex-direction: column; 
            gap: 2rem;
        }

        #preview-wrapper {
            order: 1;
            position: sticky;
            top: 0;
            z-index: 10;
            background-color: var(--background);
            padding-top: 1rem;
            padding-bottom: 1rem;
            margin: -1rem;
            padding-left: 1rem;
            padding-right: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
        }

        #editor-wrapper {
            order: 2;
        }

        #preview-wrapper .card {
            position: relative; 
        }
        
        #preview-wrapper .card-header,
        #preview-wrapper #instructions-wrapper {
            display: none;
        }

        #signature-render-area {
            transform-origin: top left;
            transition: transform 0.3s ease;
        }

        #signature-render-area.mobile-view {
            transform: scale(0.75);
            min-height: 150px;
            height: 150px;
            overflow: hidden;
        }

        .copy-btn-overlay {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            z-index: 5;
        }

        @media (min-width: 1024px) {
            .main-layout-container {
                flex-direction: row;
                align-items: flex-start;
            }

            #editor-wrapper {
                order: 1;
                flex: 1;
                min-width: 0;
            }

            #preview-wrapper {
                order: 2;
                flex: 1;
                min-width: 0;
                position: sticky;
                top: 2rem;
                padding: 0;
                margin: 0;
                background-color: transparent;
                box-shadow: none;
            }
            
            #preview-wrapper .card-header,
            #preview-wrapper #instructions-wrapper {
                display: block;
            }

            #signature-render-area.mobile-view {
                transform: scale(1);
                height: auto;
                min-height: 200px;
            }
        }

    </style>
</head>
<body class="font-body">
    <div id="app-container" class="min-h-screen p-4 md:p-8">
        </div>
    <div id="toaster-container"></div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const uccDefaultLogoSquare = 'https://firebasestorage.googleapis.com/v0/b/test-project-dev-studio.appspot.com/o/ucc-logo-square.png?alt=media&token=a5c0b1f0-4e3a-4f51-9f20-5ab16f0a6e34';
        const uccDefaultBanner = 'https://scontent.fmga1-2.fna.fbcdn.net/v/t39.30808-6/480548928_1002185092105402_8073521461074714283_n.jpg?_nc_cat=110&ccb=1-7&_nc_sid=cc71e4&_nc_ohc=n03onr9k-mwQ7kNvwFO_gjM&_nc_oc=AdmYYhNpsR4TITH4wvjVbARTjtIg0tGPyQMe7FsdIwx3yZ8Ivf3Y7xTeEpkPsmvDRHo&_nc_zt=23&_nc_ht=scontent.fmga1-2.fna&_nc_gid=_uUdcNqd_YNTH1IoePYCIQ&oh=00_AfMRnhrPcU2NkqlDiImsXxG09_0Uo88IdvW5MsOLN3dbqA&oe=684F9226';
        const defaultFieldStyle = (fontSize, color = '#333333', isBold = false, isItalic = false) => ({ color, isBold, isItalic, fontSize });
        let signatureData = { fullName: 'Noel López', title: 'UCC Virtual', nombreSede: 'Campus León', phone: 'Ext. 131 - Cel. 58085130', address: 'León, Nicaragua', websiteUrl: 'https://www.ucc.edu.ni', cita: 'La creatividad es la inteligencia divirtiéndose.', useCustomImage: false, logo: uccDefaultLogoSquare, bannerImage: uccDefaultBanner, fontFamily: 'Arial, Helvetica, sans-serif', fullNameStyle: defaultFieldStyle(20, '#000000', true, false), titleStyle: defaultFieldStyle(14, '#333333', true, false), nombreSedeStyle: defaultFieldStyle(13), addressStyle: defaultFieldStyle(12), phoneStyle: defaultFieldStyle(12), websiteUrlStyle: defaultFieldStyle(12, '#0056b3'), citaStyle: defaultFieldStyle(11, '#555555', false, true), selectedTemplate: 'classic', logoWidth: 100, logoAlignment: 'center', logoVerticalAlignment: 'middle', logoPaddingTop: 0, logoPaddingRight: 15, logoPaddingBottom: 0, logoPaddingLeft: 0, lineaSeparadoraVisible: true, lineaSeparadoraColor: '#D4AC0D', separatorThickness: 2, separatorHeight: 90, separatorMargin: 15, bannerWidth: 400, bannerHorizontalAlignment: 'center', bannerVerticalAlignment: 'center', bannerPadding: 10, containerBorderVisible: false, containerBorderColor: '#e9e9e9', containerBorderThickness: 2, containerBorderRadius: 8, containerBorderGradientStart: '#D4AC0D', containerBorderGradientEnd: '#1A5276', containerBackgroundColor: '#ffffff', containerShadowVisible: false, containerShadowX: 0, containerShadowY: 4, containerShadowBlur: 10, containerShadowColor: 'rgba(0,0,0,0.1)', infoTextAlign: 'left', infoPaddingTop: 0, infoPaddingRight: 0, infoPaddingBottom: 0, infoPaddingLeft: 15, };
        const icons = { gem: '<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon-xl"><path d="M6 3h12l4 6-10 13L2 9Z"/><path d="M12 22V9"/><path d="m3.29 9 8.71 13 8.71-13L12 3Z"/></svg>', palette: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><circle cx="13.5" cy="6.5" r=".5"/><circle cx="17.5" cy="10.5" r=".5"/><circle cx="8.5" cy="7.5" r=".5"/><circle cx="6.5" cy="12.5" r=".5"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"/></svg>', settings: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>', user: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>', briefcase: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><rect width="20" height="14" x="2" y="7" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg>', building: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><rect width="16" height="20" x="4" y="2" rx="2"/><path d="M9 22v-4h6v4"/><path d="M8 6h.01"/><path d="M16 6h.01"/><path d="M12 6h.01"/><path d="M12 10h.01"/><path d="M12 14h.01"/><path d="M16 10h.01"/><path d="M16 14h.01"/><path d="M8 10h.01"/><path d="M8 14h.01"/></svg>', mapPin: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>', phone: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>', link: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.72"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.72-1.72"/></svg>', quote: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 2v6h3v8Z"/><path d="M15 21c3 0 7-1 7-8V5c0-1.25-.75-2-2-2h-4c-1.25 0-2 .75-2 2v6h3v8Z"/></svg>', layoutDashboard: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><rect width="7" height="9" x="3" y="3" rx="1"/><rect width="7" height="5" x="14" y="3" rx="1"/><rect width="7" height="9" x="14" y="12" rx="1"/><rect width="7" height="5" x="3" y="16" rx="1"/></svg>', image: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></svg>', copy: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>', type: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><polyline points="4 7 4 4 20 4 20 7"/><line x1="9" x2="15" y1="20" y2="20"/><line x1="12" x2="12" y1="4" y2="20"/></svg>', gripVertical: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><circle cx="9" cy="12" r="1"/><circle cx="9" cy="5" r="1"/><circle cx="9" cy="19" r="1"/><circle cx="15" cy="12" r="1"/><circle cx="15" cy="5" r="1"/><circle cx="15" cy="19" r="1"/></svg>', appWindow: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="M10 4v4"/><path d="M2 8h20"/><path d="M6 4v4"/></svg>', bold: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M6 4h8a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"/><path d="M6 12h9a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"/></svg>', italic: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><line x1="19" x2="10" y1="4" y2="4"/><line x1="14" x2="5" y1="20" y2="20"/><line x1="15" x2="9" y1="4" y2="20"/></svg>', x: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>', };
        const fieldsConfig = [ { name: 'fullName', label: 'Nombre completo', icon: icons.user }, { name: 'title', label: 'Cargo', icon: icons.briefcase }, { name: 'nombreSede', label: 'Sede', icon: icons.building }, { name: 'address', label: 'Ubicación', icon: icons.mapPin }, { name: 'phone', label: 'Teléfono', icon: icons.phone, type: 'tel' }, { name: 'websiteUrl', label: 'Sitio web / Red social', icon: icons.link, type: 'url', placeholder: 'https://...' }, { name: 'cita', label: 'Cita reflexiva (opcional)', icon: icons.quote, isTextarea: true, placeholder: 'Ej: La perseverancia es la clave del éxito.' }, ];
        const appContainer = document.getElementById('app-container');
        const toasterContainer = document.getElementById('toaster-container');

        function renderApp() {
            const currentYear = new Date().getFullYear();
            const appHtml = `
                <header class="mb-8 text-center">
                    <div class="inline-flex items-center gap-3 mb-2">
                        ${icons.gem}
                        <h1 class="font-headline text-4xl font-bold text-primary">Firma de Correo</h1>
                    </div>
                    <p class="text-muted-foreground max-w-xl mx-auto">
                       Crea tu firma de correo profesional.
                    </p>
                </header>

                <main class="container mx-auto">
                    <div class="main-layout-container">
                        <div id="preview-wrapper">
                            ${renderPreviewCard()}
                        </div>
                        <div id="editor-wrapper">
                            <div class="card shadow-xl h-full">
                                <div class="card-content p-6">
                                    ${renderEditorForm()}
                                </div>
                            </div>
                        </div>
                    </div>
                </main>

                <footer class="mt-12 pt-8">
                    <p>&copy; ${currentYear} Firma de Correo Personalizado. Noel López</p>
                </footer>
            `;
            appContainer.innerHTML = appHtml;
        }

        function renderPreviewCard() {
            const isMobile = window.innerWidth < 1024;
            
            const copyButtonHtml = `<button type="button" id="copy-btn" class="btn btn-accent ${isMobile ? 'copy-btn-overlay' : 'w-full'}"> ${icons.copy} Copiar Firma </button>`;

            return `
                <div class="card h-full flex flex-col">
                    <div class="card-header">
                        <h2 class="card-title font-headline text-xl">Vista Previa</h2>
                    </div>
                    <div class="card-content flex-grow flex flex-col gap-4">
                        ${isMobile ? copyButtonHtml : ''}
                        <div id="signature-render-area" class="${isMobile ? 'mobile-view' : ''}">
                            ${generateSignatureHtml(signatureData)}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderEditorForm() { return ` <form id="signature-form" class="space-y-6"> ${renderTemplateSelector()} ${renderImageControls()} ${fieldsConfig.map(renderFormField).join('')} <div class="separator"></div> ${renderGeneralStyles()} </form> `; }
        function renderTemplateSelector() { return ` <div class="space-y-2"> <label for="selectedTemplate" class="label">${icons.layoutDashboard} Seleccionar Plantilla</label> <select id="selectedTemplate" class="select" data-property="selectedTemplate"> <option value="classic" ${signatureData.selectedTemplate === 'classic' ? 'selected' : ''}>Estilo Clásico (Logo Izq, Info Der)</option> <option value="banner" ${signatureData.selectedTemplate === 'banner' ? 'selected' : ''}>Estilo Banner (Info Arriba, Banner Abajo)</option> </select> </div>`; }
        function renderImageControls() { const showClassic = signatureData.selectedTemplate === 'classic'; const showBanner = signatureData.selectedTemplate === 'banner'; return ` <div class="flex items-center justify-between mt-4"> <label for="useCustomImage" class="label">${icons.image} Usar imagen personalizada</label> <label class="switch"> <input type="checkbox" id="useCustomImage" data-property="useCustomImage" ${signatureData.useCustomImage ? 'checked' : ''}> <span class="switch-slider"></span> </label> </div> <div class="${(signatureData.useCustomImage && showClassic) ? '' : 'hidden'}"> <label class="label mb-1">Subir Logo (para Estilo Clásico)</label> ${renderImageUpload('logo')} </div> <div class="${(signatureData.useCustomImage && showBanner) ? '' : 'hidden'}"> <label class="label mb-1">Subir Banner (para Estilo Banner)</label> ${renderImageUpload('bannerImage')} </div> <div class="${(!signatureData.useCustomImage && showClassic) ? 'space-y-1 mt-4' : 'hidden'}"> <label class="label">Logo UCC (por defecto)</label> <img src="${uccDefaultLogoSquare}" alt="Logo UCC por defecto" class="image-preview" style="object-fit:contain; border-radius:0;"> </div> <div class="${(!signatureData.useCustomImage && showBanner) ? 'space-y-1 mt-4' : 'hidden'}"> <label class="label">Banner UCC (por defecto)</label> <img src="${uccDefaultBanner}" alt="Banner UCC por defecto" style="width:100%; height:auto; border:1px solid var(--border); border-radius:0.375rem;"> </div> `; }
        function renderImageUpload(property) { const currentImage = signatureData[property]; return ` <div class="space-y-2"> <input type="file" class="input" accept="image/*" data-image-upload-for="${property}"> ${currentImage ? ` <div class="image-preview"> <img src="${currentImage}" alt="Preview"> <button type="button" class="btn btn-icon btn-ghost remove-btn" data-remove-image-for="${property}">${icons.x}</button> </div> ` : ''} </div>`; }
        function renderFormField(field) { const styleFieldPrefix = `${field.name}Style`; return ` <div class="mt-4"> <div class="flex items-center justify-between mb-1"> <label for="${field.name}" class="label">${field.icon} ${field.label}</label> <button type="button" class="btn btn-icon btn-ghost" data-toggle-style-editor="${field.name}" style="height:1.75rem; width:1.75rem;">${icons.settings}</button> </div> ${field.isTextarea ? `<textarea id="${field.name}" class="textarea" data-property="${field.name}" placeholder="${field.placeholder || ''}">${signatureData[field.name] || ''}</textarea>` : `<input id="${field.name}" type="${field.type || 'text'}" class="input" data-property="${field.name}" value="${signatureData[field.name] || ''}" placeholder="${field.placeholder || ''}">` } <div class="hidden" data-style-editor-for="${field.name}"> ${renderFieldStyleControls(styleFieldPrefix)} </div> </div> `; }
        function renderFieldStyleControls(prefix) { const style = signatureData[prefix]; return ` <div class="mt-2 mb-3 p-3 border rounded-md bg-muted/30 shadow-sm"> <div class="grid grid-cols-2 md:grid-cols-4 gap-x-4 gap-y-3 items-center"> <div> <label class="label text-xs mb-1">${icons.palette} Color</label> <input type="color" class="input" value="${style.color}" data-style-property="color" data-style-prefix="${prefix}"> </div> <div> <label class="label text-xs mb-1">Tamaño (px)</label> <input type="number" class="input text-xs" value="${style.fontSize}" data-style-property="fontSize" data-style-prefix="${prefix}"> </div> <div class="flex items-center space-x-2 pt-3"> <label class="switch"> <input type="checkbox" data-style-property="isBold" data-style-prefix="${prefix}" ${style.isBold ? 'checked' : ''}> <span class="switch-slider"></span> </label> <label class="label text-xs">${icons.bold} Negrita</label> </div> <div class="flex items-center space-x-2 pt-3"> <label class="switch"> <input type="checkbox" data-style-property="isItalic" data-style-prefix="${prefix}" ${style.isItalic ? 'checked' : ''}> <span class="switch-slider"></span> </label> <label class="label text-xs">${icons.italic} Cursiva</label> </div> </div> </div>`; }
        function renderGeneralStyles() { const webSafeFonts = [ 'Arial, Helvetica, sans-serif', 'Verdana, Geneva, sans-serif', 'Tahoma, Geneva, sans-serif', 'Trebuchet MS, Helvetica, sans-serif', 'Georgia, serif', 'Times New Roman, Times, serif', 'Courier New, Courier, monospace', 'PT Sans, sans-serif', 'Poppins, sans-serif', ]; return ` <div class="space-y-4"> <h3 class="font-headline text-lg label">${icons.palette} Estilo General de Firma</h3> <div> <label for="fontFamily" class="label font-semibold mb-1">${icons.type} Familia de Fuente</label> <select id="fontFamily" class="select" data-property="fontFamily"> ${webSafeFonts.map(font => `<option value="${font}" ${signatureData.fontFamily === font ? 'selected' : ''}>${font.split(',')[0]}</option>`).join('')} </select> </div> ${renderInfoBlockStyles()} <div class="${signatureData.selectedTemplate === 'classic' ? '' : 'hidden'}"> ${renderClassicStyles()} </div> <div class="${signatureData.selectedTemplate === 'banner' ? '' : 'hidden'}"> ${renderBannerStyles()} </div> <div class="separator"></div> <div class="space-y-3"> <h4 class="label font-semibold">${icons.appWindow} Contenedor de la Firma</h4> <div> <label class="label text-xs mb-1">Color de Fondo</label> <input type="color" class="input" data-property="containerBackgroundColor" value="${signatureData.containerBackgroundColor}"> </div> <div class="flex items-center space-x-2 pt-3"> <label class="switch"> <input type="checkbox" data-property="containerBorderVisible" ${signatureData.containerBorderVisible ? 'checked' : ''}> <span class="switch-slider"></span> </label> <label class="label text-xs">Borde Visible</label> </div> <div class="space-y-3 p-3 border rounded-md ${signatureData.containerBorderVisible ? '' : 'hidden'}"> <label class="label text-xs font-semibold">Opciones de Borde con Degradado</label> <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-end"> <div> <label class="label text-xs mb-1">Color Inicio</label> <input type="color" class="input" data-property="containerBorderGradientStart" value="${signatureData.containerBorderGradientStart}"> </div> <div> <label class="label text-xs mb-1">Color Fin</label> <input type="color" class="input" data-property="containerBorderGradientEnd" value="${signatureData.containerBorderGradientEnd}"> </div> <div> <label class="label text-xs mb-1">Grosor Borde (px)</label> <input type="number" class="input text-xs" data-property="containerBorderThickness" value="${signatureData.containerBorderThickness}"> </div> <div> <label class="label text-xs mb-1">Radio Borde (px)</label> <input type="number" class="input text-xs" data-property="containerBorderRadius" value="${signatureData.containerBorderRadius}"> </div> </div> </div> <div class="flex items-center space-x-2 pt-3"> <label class="switch"> <input type="checkbox" data-property="containerShadowVisible" ${signatureData.containerShadowVisible ? 'checked' : ''}> <span class="switch-slider"></span> </label> <label class="label text-xs">Sombra Visible</label> </div> <div class="space-y-3 p-3 border rounded-md ${signatureData.containerShadowVisible ? '' : 'hidden'}"> <label class="label text-xs font-semibold">Opciones de Sombra</label> <div class="grid grid-cols-2 md:grid-cols-4 gap-4 items-end mt-2"> <div> <label class="label text-xs mb-1">Posición X (px)</label> <input type="number" class="input text-xs" data-property="containerShadowX" value="${signatureData.containerShadowX}"> </div> <div> <label class="label text-xs mb-1">Posición Y (px)</label> <input type="number" class="input text-xs" data-property="containerShadowY" value="${signatureData.containerShadowY}"> </div> <div> <label class="label text-xs mb-1">Desenfoque (px)</label> <input type="number" class="input text-xs" data-property="containerShadowBlur" value="${signatureData.containerShadowBlur}"> </div> <div> <label class="label text-xs mb-1">Color Sombra</label> <input type="color" class="input" data-property="containerShadowColor" value="${signatureData.containerShadowColor}"> </div> </div> </div> </div> </div> `; }
        function renderInfoBlockStyles() { return ` <div class="space-y-3 mt-4"> <h4 class="label font-semibold">Estilo del Bloque de Información</h4> <div class="p-3 border rounded-md space-y-3"> <div> <label class="label text-xs mb-1">Alineación del Texto</label> <select class="select text-xs" data-property="infoTextAlign"> <option value="left" ${signatureData.infoTextAlign === 'left' ? 'selected' : ''}>Izquierda</option> <option value="center" ${signatureData.infoTextAlign === 'center' ? 'selected' : ''}>Centro</option> <option value="right" ${signatureData.infoTextAlign === 'right' ? 'selected' : ''}>Derecha</option> </select> </div> <div> <label class="label text-xs mb-1">Relleno (Padding) del Contenedor de Texto (px)</label> <div class="grid grid-cols-2 md:grid-cols-4 gap-2"> <div> <label class="label text-xs mb-1">Superior</label> <input type="number" class="input text-xs" data-property="infoPaddingTop" value="${signatureData.infoPaddingTop}"> </div> <div> <label class="label text-xs mb-1">Derecho</label> <input type="number" class="input text-xs" data-property="infoPaddingRight" value="${signatureData.infoPaddingRight}"> </div> <div> <label class="label text-xs mb-1">Inferior</label> <input type="number" class="input text-xs" data-property="infoPaddingBottom" value="${signatureData.infoPaddingBottom}"> </div> <div> <label class="label text-xs mb-1">Izquierdo</label> <input type="number" class="input text-xs" data-property="infoPaddingLeft" value="${signatureData.infoPaddingLeft}"> </div> </div> </div> </div> </div> `; }
        function renderClassicStyles() { return ` <div class="mt-4 space-y-3"> <h4 class="label font-semibold">${icons.image} Personalización del Logo (Diseño Clásico)</h4> <div class="p-3 border rounded-md space-y-4"> <div> <label class="label text-xs mb-1">Ancho del Logo (px)</label> <input type="number" class="input text-xs" data-property="logoWidth" value="${signatureData.logoWidth}"> </div> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"> <div> <label class="label text-xs mb-1">Alineación Horizontal</label> <select class="select text-xs" data-property="logoAlignment"> <option value="left" ${signatureData.logoAlignment === 'left' ? 'selected' : ''}>Izquierda</option> <option value="center" ${signatureData.logoAlignment === 'center' ? 'selected' : ''}>Centro</option> <option value="right" ${signatureData.logoAlignment === 'right' ? 'selected' : ''}>Derecha</option> </select> </div> <div> <label class="label text-xs mb-1">Alineación Vertical</label> <select class="select text-xs" data-property="logoVerticalAlignment"> <option value="top" ${signatureData.logoVerticalAlignment === 'top' ? 'selected' : ''}>Arriba</option> <option value="middle" ${signatureData.logoVerticalAlignment === 'middle' ? 'selected' : ''}>Medio</option> <option value="bottom" ${signatureData.logoVerticalAlignment === 'bottom' ? 'selected' : ''}>Abajo</option> </select> </div> </div> <div> <label class="label text-xs mb-1">Relleno (Padding) del Logo (px)</label> <div class="grid grid-cols-2 md:grid-cols-4 gap-2"> <div> <label class="label text-xs mb-1">Superior</label> <input type="number" class="input text-xs" data-property="logoPaddingTop" value="${signatureData.logoPaddingTop}"> </div> <div> <label class="label text-xs mb-1">Derecho</label> <input type="number" class="input text-xs" data-property="logoPaddingRight" value="${signatureData.logoPaddingRight}"> </div> <div> <label class="label text-xs mb-1">Inferior</label> <input type="number" class="input text-xs" data-property="logoPaddingBottom" value="${signatureData.logoPaddingBottom}"> </div> <div> <label class="label text-xs mb-1">Izquierdo</label> <input type="number" class="input text-xs" data-property="logoPaddingLeft" value="${signatureData.logoPaddingLeft}"> </div> </div> </div> </div> </div> <div class="separator"></div> <div class="space-y-3"> <div class="flex items-center justify-between"> <label class="label font-semibold">${icons.gripVertical} Línea vertical</label> <label class="switch"> <input type="checkbox" data-property="lineaSeparadoraVisible" ${signatureData.lineaSeparadoraVisible ? 'checked' : ''}> <span class="switch-slider"></span> </label> </div> <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-end ${signatureData.lineaSeparadoraVisible ? '' : 'hidden'}"> <div> <label class="label text-xs mb-1">Color línea</label> <input type="color" class="input" data-property="lineaSeparadoraColor" value="${signatureData.lineaSeparadoraColor}"> </div> <div> <label class="label text-xs mb-1">Grosor línea (px)</label> <input type="number" class="input text-xs" data-property="separatorThickness" value="${signatureData.separatorThickness}"> </div> <div> <label class="label text-xs mb-1">Altura línea (px)</label> <input type="number" class="input text-xs" data-property="separatorHeight" value="${signatureData.separatorHeight}"> </div> <div> <label class="label text-xs mb-1">Espaciado línea (px)</label> <input type="number" class="input text-xs" data-property="separatorMargin" value="${signatureData.separatorMargin}"> </div> </div> </div> `; }
        function renderBannerStyles() { return ` <div class="mt-4 space-y-2"> <label class="label font-semibold">${icons.image} Personalización del Banner</label> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"> <div> <label class="label text-xs mb-1">Ancho Banner (px)</label> <input type="number" class="input text-xs" data-property="bannerWidth" value="${signatureData.bannerWidth}"> </div> <div> <label class="label text-xs mb-1">Espaciado Banner (px)</label> <input type="number" class="input text-xs" data-property="bannerPadding" value="${signatureData.bannerPadding}"> </div> </div> </div> `; }
        const generateSignatureHtml = (data) => { const { fullName, title, nombreSede, phone, address, websiteUrl, cita, logo: customLogo, bannerImage: customBannerImage, useCustomImage, fontFamily, selectedTemplate, lineaSeparadoraVisible, lineaSeparadoraColor, separatorThickness, separatorHeight, separatorMargin, logoWidth, logoAlignment, logoVerticalAlignment, logoPaddingTop, logoPaddingRight, logoPaddingBottom, logoPaddingLeft, fullNameStyle, titleStyle, nombreSedeStyle, phoneStyle, addressStyle, websiteUrlStyle, citaStyle, bannerWidth, bannerPadding, containerBorderVisible, containerBorderThickness, containerBorderRadius, containerBorderGradientStart, containerBorderGradientEnd, containerBackgroundColor, containerShadowVisible, containerShadowX, containerShadowY, containerShadowBlur, containerShadowColor, infoTextAlign, infoPaddingTop, infoPaddingRight, infoPaddingBottom, infoPaddingLeft } = data; const effectiveLogo = useCustomImage && customLogo ? customLogo : uccDefaultLogoSquare; const effectiveBanner = useCustomImage && customBannerImage ? customBannerImage : uccDefaultBanner; const getFieldHtml = (content, style, tag = 'div', isLink = false, href = '#') => { if (!content) return ''; const inlineStyle = `font-weight: ${style.isBold ? 'bold' : 'normal'}; font-style: ${style.isItalic ? 'italic' : 'normal'}; font-size: ${style.fontSize}px; margin: 0; padding: 0; line-height: 1.4; color: ${style.color};`; if (isLink && href) { return `<${tag} style="margin: 0; padding:0;"><a href="${href}" target="_blank" rel="noopener noreferrer" style="${inlineStyle} text-decoration: none;">${content}</a></${tag}>`; } return `<${tag} style="${inlineStyle}">${content}</${tag}>`; }; let tableContainerStyle = `font-family: ${fontFamily}; font-size: 12px; line-height: 1.5; border-collapse: collapse; padding: 15px; width: 100%; max-width: 550px; background-color: ${containerBackgroundColor}; border-radius: ${containerBorderRadius}px;`; if (containerBorderVisible) { tableContainerStyle += ` border: ${containerBorderThickness}px solid transparent; background-image: linear-gradient(${containerBackgroundColor}, ${containerBackgroundColor}), linear-gradient(to right, ${containerBorderGradientStart}, ${containerBorderGradientEnd}); background-origin: border-box; background-clip: content-box, border-box;`; } if (containerShadowVisible) { tableContainerStyle += ` box-shadow: ${containerShadowX}px ${containerShadowY}px ${containerShadowBlur}px ${containerShadowColor};`; } const infoContainerStyle = `text-align: ${infoTextAlign}; padding: ${infoPaddingTop}px ${infoPaddingRight}px ${infoPaddingBottom}px ${infoPaddingLeft}px;`; const cleanPhone = phone ? phone.replace(/[^0-9+]/g, '') : ''; let finalHtml = ''; if (selectedTemplate === 'classic') { const logoContainerStyle = `vertical-align: ${logoVerticalAlignment}; text-align: ${logoAlignment}; padding: ${logoPaddingTop}px ${logoPaddingRight}px ${logoPaddingBottom}px ${logoPaddingLeft}px;`; const separatorHtml = lineaSeparadoraVisible ? ` <td style="vertical-align: ${logoVerticalAlignment}; padding: 0 ${separatorMargin}px;"> <div style="height: ${separatorHeight}px; width: ${separatorThickness}px; background-color: ${lineaSeparadoraColor};"></div> </td>` : '<td></td>'; finalHtml = ` <table style="${tableContainerStyle}" cellpadding="0" cellspacing="0" border="0"> <tbody> <tr> <td style="${logoContainerStyle}"> ${effectiveLogo ? `<img src="${effectiveLogo}" alt="Logo" width="${logoWidth}" style="width: ${logoWidth}px; height: auto; display: inline-block; border-radius: 4px;">` : ''} </td> ${separatorHtml} <td style="vertical-align: ${logoVerticalAlignment}; ${infoContainerStyle}"> ${getFieldHtml(fullName, fullNameStyle)} ${getFieldHtml(title, titleStyle)} ${getFieldHtml(nombreSede, nombreSedeStyle)} ${getFieldHtml(address, addressStyle)} ${getFieldHtml(phone, phoneStyle, 'div', true, `tel:${cleanPhone}`)} ${getFieldHtml(websiteUrl, websiteUrlStyle, 'div', true, websiteUrl)} ${getFieldHtml(cita, citaStyle)} </td> </tr> </tbody> </table>`; } else { finalHtml = ` <table style="${tableContainerStyle}" cellpadding="0" cellspacing="0" border="0"> <tbody> <tr> <td> <div style="${infoContainerStyle} padding-bottom: 10px;"> ${getFieldHtml(fullName, fullNameStyle)} ${getFieldHtml(title, titleStyle)} ${getFieldHtml(nombreSede, nombreSedeStyle)} ${getFieldHtml(address, addressStyle)} ${getFieldHtml(phone, phoneStyle, 'div', true, `tel:${cleanPhone}`)} ${getFieldHtml(websiteUrl, websiteUrlStyle, 'div', true, websiteUrl)} ${getFieldHtml(cita, citaStyle)} </div> </td> </tr> ${effectiveBanner ? ` <tr> <td style="padding-top: ${bannerPadding}px; text-align: center;"> <img src="${effectiveBanner}" alt="Banner" width="${bannerWidth}" style="width: ${bannerWidth}px; max-width: 100%; height: auto; display: inline-block;"> </td> </tr>` : ''} </tbody> </table>`; } return finalHtml; };
        
        function updateAndRerender() { const formContainer = document.querySelector('#editor-wrapper .card-content'); if (formContainer) formContainer.innerHTML = renderEditorForm(); const previewContainer = document.getElementById('preview-wrapper'); if (previewContainer) previewContainer.innerHTML = renderPreviewCard(); }
        function showToast(title, description, variant = 'default') { const toast = document.createElement('div'); toast.className = `toast ${variant}`; toast.innerHTML = `<div class="toast-title">${title}</div>${description ? `<div>${description}</div>` : ''}`; toasterContainer.appendChild(toast); setTimeout(() => { toast.remove(); }, 3000); }
        async function handleCopyHtml() { const html = generateSignatureHtml(signatureData); try { const blob = new Blob([html], { type: 'text/html' }); const clipboardItem = new ClipboardItem({ 'text/html': blob }); await navigator.clipboard.write([clipboardItem]); showToast("¡Firma Copiada!", "HTML de la firma copiado. Pégalo en tu cliente de correo."); } catch (err) { console.error("Fallo al copiar HTML enriquecido: ", err); try { await navigator.clipboard.writeText(html); showToast("Copiado como Texto Plano", "El HTML se copió como texto. Si ves el código al pegar, usa un navegador más moderno.", "destructive"); } catch (fallbackErr) { console.error("Fallo al copiar como texto plano:", fallbackErr); showToast("Fallo al Copiar", "No se pudo copiar el HTML al portapapeles.", "destructive"); } } }
        appContainer.addEventListener('input', e => { const target = e.target; if (target.dataset.property) { const property = target.dataset.property; const value = target.type === 'number' ? (parseInt(target.value, 10) || 0) : target.value; signatureData[property] = value; document.getElementById('signature-render-area').innerHTML = generateSignatureHtml(signatureData); } if (target.dataset.styleProperty) { const property = target.dataset.styleProperty; const prefix = target.dataset.stylePrefix; const value = target.type === 'checkbox' ? target.checked : (target.type === 'number' ? (parseInt(target.value, 10) || 0) : target.value); signatureData[prefix][property] = value; document.getElementById('signature-render-area').innerHTML = generateSignatureHtml(signatureData); } });
        appContainer.addEventListener('change', e => { const target = e.target; if (target.matches('select[data-property], input[type="checkbox"][data-property]')) { const property = target.dataset.property; const value = target.type === 'checkbox' ? target.checked : target.value; signatureData[property] = value; if (property === 'useCustomImage') { if (!value) { signatureData.logo = uccDefaultLogoSquare; signatureData.bannerImage = uccDefaultBanner; } else { if (signatureData.logo === uccDefaultLogoSquare) signatureData.logo = null; if (signatureData.bannerImage === uccDefaultBanner) signatureData.bannerImage = null; } } updateAndRerender(); } if (target.dataset.imageUploadFor) { const property = target.dataset.imageUploadFor; const file = e.target.files[0]; if (file) { const reader = new FileReader(); reader.onloadend = () => { signatureData[property] = reader.result; updateAndRerender(); }; reader.readAsDataURL(file); } } });
        appContainer.addEventListener('click', e => { const target = e.target.closest('button'); if (!target) return; if (target.id === 'copy-btn') { handleCopyHtml(); } if (target.dataset.toggleStyleEditor) { const fieldName = target.dataset.toggleStyleEditor; const editor = document.querySelector(`[data-style-editor-for="${fieldName}"]`); if (editor) { editor.classList.toggle('hidden'); } } if (target.dataset.removeImageFor) { const property = target.dataset.removeImageFor; signatureData[property] = null; updateAndRerender(); } });

        let resizeTimeout;
        function onResize() {
            renderApp();
        }
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(onResize, 150);
        });

        renderApp();
    });
    </script>
</body>
</html>